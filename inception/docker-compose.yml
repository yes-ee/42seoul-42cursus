# docker-compose의 버전
version: '3'

# 컨테이너 안에 쌓인 데이터는 컨테이너를 삭제하면 다 날라감
# 이 데이터를 외부 저장소에 보관하고 싶을 때 볼륨을 사용함
# 여러 컨테이너 간 데이터를 공유해서 사용할 때도 볼륨 사용 가능
volumes:
  data: {}

# 3개의 컨테이너를 띄움
services:
  # 만들 서비스 이름
  mariadb:
    # 끝에서 두 번째로 stable한 버전 사용
    image: debian:bullseye
    restart: always
    # 도커 네트워크 안에서 해당 포트로 통신
    # 네트워크 내부의 다른 컨테이너들만 엑세스 가능
    expose:
      - "3306"
    networks:
      - intra
    # 터미널 입력 관련 설정
    tty: true
  nginx:
    image: debian:bullseye
    restart: always
    # 컨테이너와 호스트 사이 통신
    ports:
      - "443:443"
    volumes:
      - data:/var/www/html
    networks:
      - intra
    tty: true
  wordpress:
    image: debian:bullseye
    restart: always
    volumes:
      - data:/var/www/html
    expose:
      - "9000"
    networks:
      - intra
    tty: true

networks:
  # network 이름
  intra:
    # bridge 방식으로 생성
    driver: bridge